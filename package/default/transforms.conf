#
# SWIFT AGI Add-on for Splunk
#
# File:         transforms.conf
#
#

#
# SWIFT AGI Activity
#

# INCOMING-NETWORK-MESSAGE-ERROR
[swift_agi_activity_incoming_network_message_error]
REGEX = (?<activity_time>[^\|]+)\|(?<container_id>[^\|]+)\|(?<micro_service>[^\|]+)\|(?<process_id>[^\|]+)\|(?<thread_id>[^\|]+)\|(?<activity>INCOMING-NETWORK-MESSAGE-ERROR)\|(?<partner>[^\|]+)\|(?<msg_id>[^\|]+)\|(?<biz_id>[^\|]+)\|(?<poss_dupl>[^\|]+)\|(?<bef_wan_get_time>[^\|]+)\|(?<aft_wan_get_time>[^\|]+)\|(?<sign_req_creat_dur_ms>[^\|]+)\|(?<bef_verif_time>[^\|]+)\|(?<aft_verif_time>[^\|]+)\|(?<bef_bo_put_time>[^\|]+)\|(?<aft_bo_put_time>[^\|]+)\|(?<bef_nr_put_time>[^\|]+)\|(?<aft_nr_put_time>[^\|]+)\|(?<bef_ack_put_time>[^\|]+)\|(?<aft_ack_put_time>[^\|]+)\|(?<verify_bef_vldt_cert_time>[^\|]+)\|(?<verify_aft_vldt_cert_time>[^\|]+)\|(?<verify_bef_vldt_sign_time>[^\|]+)\|(?<verify_aft_vldt_sign_time>[^\|]+)\|(?<decomp_time>[^\|]+)\|(?<size_bef_comp>[^\|]+)\|(?<size_aft_comp>[^\|]+)\|(?<size_aft_decomp>[^\|]+)\|(?<tx_span_trace_id>[^\|]+)\|(?<tx_span_id>[^\|]+)

# INCOMING-RECEIVE-INDICATION
[swift_agi_activity_incoming_receive_indication]
REGEX = (?<activity_time>[^\|]+)\|(?<container_id>[^\|]+)\|(?<micro_service>[^\|]+)\|(?<process_id>[^\|]+)\|(?<thread_id>[^\|]+)\|(?<activity>INCOMING-RECEIVE-INDICATION)\|(?<partner>[^\|]+)\|(?<msg_id>[^\|]+)\|(?<biz_id>[^\|]+)\|(?<poss_dupl>[^\|]+)\|(?<bef_wan_get_time>[^\|]+)\|(?<aft_wan_get_time>[^\|]+)\|(?<sign_req_creat_dur_ms>[^\|]+)\|(?<bef_verif_time>[^\|]+)\|(?<aft_verif_time>[^\|]+)\|(?<bef_bo_put_time>[^\|]+)\|(?<aft_bo_put_time>[^\|]+)\|(?<bef_nr_put_time>[^\|]+)\|(?<aft_nr_put_time>[^\|]+)\|(?<bef_ack_put_time>[^\|]+)\|(?<aft_ack_put_time>[^\|]+)\|(?<verify_bef_vldt_cert_time>[^\|]+)\|(?<verify_aft_vldt_cert_time>[^\|]+)\|(?<verify_bef_vldt_sign_time>[^\|]+)\|(?<verify_aft_vldt_sign_time>[^\|]+)\|(?<decomp_time>[^\|]+)\|(?<size_bef_comp>[^\|]+)\|(?<size_aft_comp>[^\|]+)\|(?<size_aft_decomp>[^\|]+)\|(?<tx_span_trace_id>[^\|]+)\|(?<tx_span_id>[^\|]+)

# INCOMING-UNKNOWN-NETWORK-MESSAGE-ERROR
[swift_agi_activity_incoming_unknown_network_message_error]
REGEX = (?<activity_time>[^\|]+)\|(?<container_id>[^\|]+)\|(?<micro_service>[^\|]+)\|(?<process_id>[^\|]+)\|(?<thread_id>[^\|]+)\|(?<activity>INCOMING-UNKNOWN-NETWORK-MESSAGE-ERROR)\|(?<partner>[^\|]+)\|(?<msg_id>[^\|]+)\|(?<biz_id>[^\|]+)\|(?<poss_dupl>[^\|]+)\|(?<bef_wan_get_time>[^\|]+)\|(?<aft_wan_get_time>[^\|]+)\|(?<sign_req_creat_dur_ms>[^\|]+)\|(?<bef_verif_time>[^\|]+)\|(?<aft_verif_time>[^\|]+)\|(?<bef_bo_put_time>[^\|]+)\|(?<aft_bo_put_time>[^\|]+)\|(?<bef_nr_put_time>[^\|]+)\|(?<aft_nr_put_time>[^\|]+)\|(?<bef_ack_put_time>[^\|]+)\|(?<aft_ack_put_time>[^\|]+)\|(?<verify_bef_vldt_cert_time>[^\|]+)\|(?<verify_aft_vldt_cert_time>[^\|]+)\|(?<verify_bef_vldt_sign_time>[^\|]+)\|(?<verify_aft_vldt_sign_time>[^\|]+)\|(?<decomp_time>[^\|]+)\|(?<size_bef_comp>[^\|]+)\|(?<size_aft_comp>[^\|]+)\|(?<size_aft_decomp>[^\|]+)\|(?<tx_span_trace_id>[^\|]+)\|(?<tx_span_id>[^\|]+)

# INCOMING-RECEIVE-INDICATION-ERROR
[swift_agi_activity_incoming_receive_indication_error]
REGEX = (?<activity_time>[^\|]+)\|(?<container_id>[^\|]+)\|(?<micro_service>[^\|]+)\|(?<process_id>[^\|]+)\|(?<thread_id>[^\|]+)\|(?<activity>[^\|]+)\|(?<partner>[^\|]+)\|(?<msg_id>[^\|]+)\|(?<biz_id>[^\|]+)\|(?<poss_dupl>[^\|]+)\|(?<bef_wan_get_time>[^\|]+)\|(?<aft_wan_get_time>[^\|]+)\|(?<sign_req_creat_dur_ms>[^\|]+)\|(?<bef_verif_time>[^\|]+)\|(?<aft_verif_time>[^\|]+)\|(?<bef_bo_put_time>[^\|]+)\|(?<aft_bo_put_time>[^\|]+)\|(?<bef_nr_put_time>[^\|]+)\|(?<aft_nr_put_time>[^\|]+)\|(?<bef_ack_put_time>[^\|]+)\|(?<aft_ack_put_time>[^\|]+)\|(?<verify_bef_vldt_cert_time>[^\|]+)\|(?<verify_aft_vldt_cert_time>[^\|]+)\|(?<verify_bef_vldt_sign_time>[^\|]+)\|(?<verify_aft_vldt_sign_time>[^\|]+)\|(?<decomp_time>[^\|]+)\|(?<size_bef_comp>[^\|]+)\|(?<size_aft_comp>[^\|]+)\|(?<size_aft_decomp>[^\|]+)\|(?<tx_span_trace_id>[^\|]+)\|(?<tx_span_id>[^\|]+)

# MQ-GET-REQUEST
[swift_agi_activity_mq_get_request]
REGEX = (?<activity_time>[^\|]+)\|(?<container_id>[^\|]+)\|(?<micro_service>[^\|]+)\|(?<process_id>[^\|]+)\|(?<thread_id>[^\|]+)\|(?<activity>MQ-GET-REQUEST)\|(?<partner_name>[^\|]+)\|(?<msg_id>[^\|]+)\|(?<biz_msg_id>[^\|]+)\|(?<poss_dupl>[^\|]+)\|(?<primitive_type>[^\|]+)\|(?<queue>[^\|]+)\|(?<sender>[^\|]+)\|(?<receiver>[^\|]+)\|(?<message_type>[^\|]+)\|(?<service>[^\|]+)\|(?<mq_put_time>[^\|]+)\|(?<mq_bef_get_time>[^\|]+)\|(?<mq_aft_get_time>[^\|]+)\|(?<mq_to_orch_time>[^\|]+)\|(?<tx_span_trace_id>[^\|]+)\|(?<tx_span_id>[^\|]+)\|(?<mq_activity_start_time>[^\|]+)\|(?<mq_processing_start_time>[^\|]+)

# MQ-PUT-REQUEST
[swift_agi_activity_mq_put_request]
REGEX = (?<activity_time>[^\|]+)\|(?<container_id>[^\|]+)\|(?<micro_service>[^\|]+)\|(?<process_id>[^\|]+)\|(?<thread_id>[^\|]+)\|(?<activity>MQ-PUT-REQUEST)\|(?<partner_name>[^\|]+)\|(?<msg_id>[^\|]+)\|(?<biz_msg_id>[^\|]+)\|(?<poss_dupl>[^\|]+)\|(?<primitive_type>[^\|]+)\|(?<queue>[^\|]+)\|(?<sender>[^\|]+)\|(?<receiver>[^\|]+)\|(?<message_type>[^\|]+)\|(?<service>[^\|]+)\|(?<mq_bef_put_time>[^\|]+)\|(?<mq_aft_put_time>[^\|]+)\|(?<msg_put_id>[^\|]+)\|(?<tx_span_trace_id>[^\|]+)\|(?<tx_span_id>[^\|]+)\|(?<mq_activity_start_time>[^\|]+)\|(?<mq_processing_start_time>[^\|]+)\|(?<mq_retries>[^\|]+)\|(?<mq_max_put_duration>[^\|]+)

# MQ-GET-REQUEST-ERROR
[swift_agi_activity_mq_get_request_error]
REGEX = (?<activity_time>[^\|]+)\|(?<container_id>[^\|]+)\|(?<micro_service>[^\|]+)\|(?<process_id>[^\|]+)\|(?<thread_id>[^\|]+)\|(?<activity>MQ-GET-REQUEST-ERROR)\|(?<partner_name>[^\|]+)\|(?<msg_id>[^\|]+)\|(?<biz_msg_id>[^\|]+)\|(?<poss_dupl>[^\|]+)\|(?<primitive_type>[^\|]+)\|(?<queue>[^\|]+)\|(?<sender>[^\|]+)\|(?<receiver>[^\|]+)\|(?<message_type>[^\|]+)\|(?<service>[^\|]+)\|(?<mq_put_time>[^\|]+)\|(?<mq_bef_get_time>[^\|]+)\|(?<mq_aft_get_time>[^\|]+)\|(?<mq_to_orch_time>[^\|]+)\|(?<tx_span_trace_id>[^\|]+)\|(?<tx_span_id>[^\|]+)\|(?<mq_activity_start_time>[^\|]+)\|(?<mq_processing_start_time>[^\|]+)

# MQ-PUT-REQUEST-ERROR
[swift_agi_activity_mq_put_request_error]
REGEX = (?<activity_time>[^\|]+)\|(?<container_id>[^\|]+)\|(?<micro_service>[^\|]+)\|(?<process_id>[^\|]+)\|(?<thread_id>[^\|]+)\|(?<activity>MQ-PUT-REQUEST-ERROR)\|(?<partner_name>[^\|]+)\|(?<msg_id>[^\|]+)\|(?<biz_msg_id>[^\|]+)\|(?<poss_dupl>[^\|]+)\|(?<primitive_type>[^\|]+)\|(?<queue>[^\|]+)\|(?<sender>[^\|]+)\|(?<receiver>[^\|]+)\|(?<message_type>[^\|]+)\|(?<service>[^\|]+)\|(?<mq_bef_put_time>[^\|]+)\|(?<mq_aft_put_time>[^\|]+)\|(?<msg_put_id>[^\|]+)\|(?<tx_span_trace_id>[^\|]+)\|(?<tx_span_id>[^\|]+)\|(?<mq_activity_start_time>[^\|]+)\|(?<mq_processing_start_time>[^\|]+)\|(?<mq_retries>[^\|]+)\|(?<mq_max_put_duration>[^\|]+)

# OUTGOING-IMP-SEND-REQUEST
[swift_agi_activity_outgoing_imp_send_request]
REGEX = (?<activity_time>[^\|]+)\|(?<container_id>[^\|]+)\|(?<micro_service>[^\|]+)\|(?<process_id>[^\|]+)\|(?<thread_id>[^\|]+)\|(?<activity>UTGOING-IMP-SEND-REQUEST)\|(?<partner>[^\|]+)\|(?<msg_id>[^\|]+)\|(?<biz_id>[^\|]+)\|(?<poss_dupl>[^\|]+)\|(?<orch_bef_bo_get_time>[^\|]+)\|(?<orch_aft_bo_get_time>[^\|]+)\|(?<sign_req_creat_dur_ms>[^\|]+)\|(?<orch_bef_sign_time>[^\|]+)\|(?<orch_aft_sign_time>[^\|]+)\|(?<orch_bef_wan_put_time>[^\|]+)\|(?<orch_aft_wan_put_time>[^\|]+)\|(?<orch_bef_bo_put_time>[^\|]+)\|(?<orch_aft_bo_put_time>[^\|]+)\|(?<orch_bef_nr_put_time>[^\|]+)\|(?<orch_aft_nr_put_time>[^\|]+)\|(?<orch_aft_act_time>[^\|]+)\|(?<sign_bef_self_vrfy_time>[^\|]+)\|(?<sign_aft_self_vrfy_time>[^\|]+)\|(?<sign_bef_sign_crea_time>[^\|]+)\|(?<sign_aft_sign_crea_time>[^\|]+)\|(?<comp_time>[^\|]+)\|(?<size_bef_comp>[^\|]+)\|(?<size_aft_comp>[^\|]+)\|(?<tx_span_trace_id>[^\|]+)\|(?<tx_span_id>[^\|]+)

# OUTGOING-IMP-SEND-REQUEST-ERROR
[swift_agi_activity_outgoing_imp_send_request_error]
REGEX = (?<activity_time>[^\|]+)\|(?<container_id>[^\|]+)\|(?<micro_service>[^\|]+)\|(?<process_id>[^\|]+)\|(?<thread_id>[^\|]+)\|(?<activity>OUTGOING-IMP-SEND-REQUEST-ERROR)\|(?<partner>[^\|]+)\|(?<msg_id>[^\|]+)\|(?<biz_id>[^\|]+)\|(?<poss_dupl>[^\|]+)\|(?<orch_bef_bo_get_time>[^\|]+)\|(?<orch_aft_bo_get_time>[^\|]+)\|(?<sign_req_creat_dur_ms>[^\|]+)\|(?<orch_bef_sign_time>[^\|]+)\|(?<orch_aft_sign_time>[^\|]+)\|(?<orch_bef_wan_put_time>[^\|]+)\|(?<orch_aft_wan_put_time>[^\|]+)\|(?<orch_bef_bo_put_time>[^\|]+)\|(?<orch_aft_bo_put_time>[^\|]+)\|(?<orch_bef_nr_put_time>[^\|]+)\|(?<orch_aft_nr_put_time>[^\|]+)\|(?<orch_aft_act_time>[^\|]+)\|(?<sign_bef_self_vrfy_time>[^\|]+)\|(?<sign_aft_self_vrfy_time>[^\|]+)\|(?<sign_bef_sign_crea_time>[^\|]+)\|(?<sign_aft_sign_crea_time>[^\|]+)\|(?<comp_time>[^\|]+)\|(?<size_bef_comp>[^\|]+)\|(?<size_aft_comp>[^\|]+)\|(?<tx_span_trace_id>[^\|]+)\|(?<tx_span_id>[^\|]+)

# INCOMING-TECHNICAL-ACK
[swift_agi_activity_incoming_technical_ack]
REGEX = (?<activity_time>[^\|]+)\|(?<container_id>[^\|]+)\|(?<micro_service>[^\|]+)\|(?<process_id>[^\|]+)\|(?<thread_id>[^\|]+)\|(?<activity>INCOMING-TECHNICAL-ACK)\|(?<partner>[^\|]+)\|(?<msg_id>[^\|]+)\|(?<biz_id>[^\|]+)\|(?<poss_dupl>[^\|]+)\|(?<bef_wan_get_time>[^\|]+)\|(?<ack_type>[^\|]+)\|(?<aft_act_time>[^\|]+)\|(?<tx_span_trace_id>[^\|]+)\|(?<tx_span_id>[^\|]+)

